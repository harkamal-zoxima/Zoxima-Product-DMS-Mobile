"Visits As screen.'phoneLayout_FluidGridWithHeaderPageLayout_ver3.0'":
    Fill: =RGBA(59, 59, 59, 1)
    OnHidden: =Set(VarDialogOpen, false);
    OnVisible: |-
        =Clear(PrimaryCart);
        Set(
            varOpen,
            false
        );
        Refresh(Visits_1);
        If(
            Connection.Connected,
            ClearCollect(
                OfflineVisits,
                Visits_1
            );
            
        );
        Set(
            VarVisit,
            false
        );
        Set(VarDialogOpen, false);
        ClearCollect(SelectedVisitForEdit, First(Visits_1));

    Canvas2 As fluidGrid.fluidGridWithBlankCard:
        BorderThickness: =0
        Height: =901
        Width: =Parent.Width
        Y: =138
        ZIndex: =1

        DataCard2 As dataCard:
            BorderColor: =RGBA(0, 0, 0, 1)
            BorderStyle: =BorderStyle.Solid
            BorderThickness: =0
            DisplayMode: =DisplayMode.Edit
            Fill: =RGBA(0, 0, 0, 0)
            Height: =883
            Width: =Parent.Width
            X: =0
            Y: =0
            ZIndex: =1

            Gallery5 As gallery.galleryVertical:
                Height: =904
                Items: |-
                    =Filter(
                        If(
                            IsBlank(SelectedVisitDate),
                            Filter(
                                Visits_1,
                                'Created By'.User = LookUp(
                                    Users,
                                    'Primary Email' = User().Email
                                ).User && IsToday('Visit Date')
                            ),
                            Filter(
                                Visits_1,
                                'Visit Date' = SelectedVisitDate && 'Created By'.User = LookUp(
                                    Users,
                                    'Primary Email' = User().Email
                                ).User
                            )
                        ),
                       'Visit Search'.Text in Customer.'Account Name (name)' 
                    )
                Layout: =Layout.Vertical
                ShowScrollbar: =false
                TemplateSize: =266
                ZIndex: =1

                Rectangle4 As rectangle:
                    BorderColor: |-
                        =If(ThisItem.status= 'status (Visits_1)'.Started && IsToday(ThisItem.'Visit Date'), ColorValue("#A00002"), RGBA(230, 230, 230, 1))
                    BorderThickness: =If(ThisItem.status= 'status (Visits_1)'.Started && IsToday(ThisItem.'Visit Date'), 1, 1)
                    Fill: =RGBA(88, 103, 130, 1)
                    Height: =262
                    HoverFill: =
                    OnSelect: =Select(Parent)
                    PressedFill: =RGBA(0, 0, 0, 0)
                    Width: =630
                    ZIndex: =1

                name As label:
                    Color: =RGBA(255, 255, 255, 1)
                    Font: =Font.Lato
                    FontWeight: =FontWeight.Semibold
                    Height: =54
                    OnSelect: =Select(Parent)
                    Size: =19
                    Text: = ThisItem.Customer.'Account Name (name)'
                    Width: =309
                    X: =76
                    ZIndex: =2

                Label15_3 As label:
                    Color: =RGBA(255, 191, 0, 1)
                    Font: =Font.Lato
                    Height: =38
                    OnSelect: =Select(Parent)
                    Size: =14
                    Text: |-
                        =ThisItem.Customer.'Address 1: Street 1'
                    Width: =311
                    X: =78
                    Y: =42
                    ZIndex: =3

                Button7_4 As button:
                    BorderColor: =RGBA(227, 100, 41, 1)
                    BorderThickness: =1
                    Color: =RGBA(227, 100, 41, 1)
                    DisabledColor: =RGBA(0,0,0, 0.7)
                    DisplayMode: =DisplayMode.Disabled
                    Fill: =RGBA(0, 0, 0, 0)
                    FocusedBorderColor: =ColorFade(Self.Fill, 75%)
                    Font: =Font.Lato
                    FontWeight: =FontWeight.Normal
                    Height: =30
                    HoverColor: =RGBA(0, 0, 0, 1)
                    HoverFill: =ColorFade(RGBA(56, 96, 178, 0), -20%)
                    PaddingTop: =3
                    RadiusBottomLeft: =9
                    RadiusBottomRight: =9
                    RadiusTopLeft: =9
                    RadiusTopRight: =9
                    Text: =ThisItem.status
                    Width: =135
                    X: =389
                    Y: =22
                    ZIndex: =4

                Icon1_12 As icon.Edit:
                    Color: =RGBA(255, 191, 0, 1)
                    DisplayMode: =If(ThisItem.status = 'status (Visits_1)'.Started || ThisItem.status = 'status (Visits_1)'.Completed ,DisplayMode.Disabled, DisplayMode.Edit)
                    Height: =44
                    Icon: =Icon.Edit
                    OnSelect: |-
                        =Set(VarEditDialogOpen, true);
                        ClearCollect(SelectedVisitForEdit, ThisItem);
                    Width: =26
                    X: =580
                    Y: =16
                    ZIndex: =5

                Label19_33 As label:
                    Color: =RGBA(217, 217, 217, 1)
                    Font: =Font.Lato
                    Height: =25
                    OnSelect: =Select(Parent)
                    Size: =14
                    Text: ="Type"
                    Width: =72
                    X: =38
                    Y: =89
                    ZIndex: =6

                Label19_34 As label:
                    Color: =RGBA(255, 255, 255, 1)
                    Font: =Font.Lato
                    FontWeight: =FontWeight.Bold
                    Height: =25
                    OnSelect: =Select(Parent)
                    Size: =14
                    Text: =ThisItem.'Visit Type'
                    Width: =200
                    X: =185
                    Y: =89
                    ZIndex: =7

                Label19_37 As label:
                    Color: =RGBA(217, 217, 217, 1)
                    Font: =Font.Lato
                    Height: =25
                    OnSelect: =Select(Parent)
                    Size: =14
                    Text: ="Visit ID"
                    Width: =147
                    X: =38
                    Y: =132
                    ZIndex: =8

                Label19_38 As label:
                    Color: =RGBA(255, 255, 255, 1)
                    Font: =Font.Lato
                    FontWeight: =FontWeight.Bold
                    Height: =25
                    OnSelect: =Select(Parent)
                    Size: =14
                    Text: =ThisItem.'Visit ID'
                    Width: =200
                    X: =185
                    Y: =132
                    ZIndex: =9

                Label19_43 As label:
                    Color: =RGBA(217, 217, 217, 1)
                    Font: =Font.Lato
                    Height: =23
                    OnSelect: =Select(Parent)
                    Size: =12
                    Text: ="Last Order Date"
                    Width: =157
                    X: =389
                    Y: =97
                    ZIndex: =10

                Label19_41 As label:
                    Color: =RGBA(255, 255, 255, 1)
                    Font: =Font.Lato
                    FontWeight: =FontWeight.Bold
                    Height: =25
                    OnSelect: =Select(Parent)
                    Size: =12
                    Text: ="12/05/2022"
                    Width: =157
                    X: =389
                    Y: =72
                    ZIndex: =11

                Label19_44 As label:
                    Color: =RGBA(217, 217, 217, 1)
                    Font: =Font.Lato
                    Height: =23
                    OnSelect: =Select(Parent)
                    Size: =12
                    Text: ="Last Order Value"
                    Width: =157
                    X: =389
                    Y: =162
                    ZIndex: =12

                Label19_42 As label:
                    Color: =RGBA(255, 255, 255, 1)
                    Font: =Font.Lato
                    FontWeight: =FontWeight.Bold
                    Height: =25
                    OnSelect: =Select(Parent)
                    Size: =12
                    Text: =Concatenate("â‚¹", RandBetween(11000, 36000))
                    Width: =157
                    X: =389
                    Y: =137
                    ZIndex: =13

                Icon1_13 As icon.Edit:
                    Color: =RGBA(255, 191, 0, 1)
                    Height: =32
                    Icon: =Icon.Phone
                    OnSelect: |-
                        =Launch("tel://"&ThisItem.Customer.'Main Phone')
                    Width: =30
                    X: =536
                    Y: =22
                    ZIndex: =14

                Rectangle9_1 As rectangle:
                    Fill: =RGBA(219, 219, 219, 1)
                    Height: =3
                    OnSelect: =Select(Parent)
                    Width: =558
                    X: =38
                    Y: =194
                    ZIndex: =17

                Button8 As button:
                    DisplayMode: |-
                        =If(
                            ThisItem.status = 'status (Visits_1)'.Completed || !IsToday(ThisItem.'Visit Date') || varAttendance="done",
                            DisplayMode.Disabled,
                            DisplayMode.Edit
                        )
                    Fill: =RGBA(160, 0, 2, 1)
                    FocusedBorderColor: =ColorFade(Self.Fill, 75%)
                    Font: =Font.Lato
                    Height: =31
                    OnSelect: |-
                        =If(
                            !IsBlank(
                                LookUp(
                                    Visits_1,
                                    IsToday('Visit Date') && status = 'status (Visits_1)'.Started
                                )
                            ) && ThisItem.status = 'status (Visits_1)'.Open || ThisItem.status = 'status (Visits_1)'.Completed,
                            Notify(
                                "One Visit is already started. Please end that visit first!",
                                NotificationType.Error,
                                2000
                            ),
                            Set(
                                VarDialogOpen,
                                !VarDialogOpen
                            );
                            Set(
                                ClickedVisit,
                                ThisItem
                            );
                            Set(
                                VisitStarted,
                                true
                            );
                            
                        )
                    Size: =16
                    Text: =If(ThisItem.status = 'status (Visits_1)'.Started , "RESUME" , "START")
                    Width: =131
                    X: =154
                    Y: =211
                    ZIndex: =24

                Group25 As group:
                    Height: =5
                    Width: =5
                    X: =40
                    Y: =40
                    ZIndex: =24

                    Circle4 As circle:
                        Fill: =RGBA(256*Rand(), 256*Rand(), 256*Rand(), 0.3)
                        Height: =50
                        HoverFill: =RGBA(256*Rand(), 256*Rand(), 256*Rand(), 1)
                        OnSelect: =Select(Parent)
                        Width: =50
                        X: =16
                        Y: =10
                        ZIndex: =18

                    Label36 As label:
                        Align: =Align.Center
                        Color: =RGBA(255, 255, 255, 1)
                        FontWeight: =FontWeight.Semibold
                        Height: =29
                        OnSelect: =Select(Parent)
                        Size: =20
                        Text: =Left(ThisItem.Customer.'Account Name (name)',1)
                        Width: =39
                        X: =21
                        Y: =20
                        ZIndex: =19

                Button8_1 As button:
                    DisplayMode: |-
                        =If(
                            ThisItem.status = 'status (Visits_1)'.Completed || !IsToday(ThisItem.'Visit Date') || varAttendance="done",
                            DisplayMode.Disabled,
                            DisplayMode.Edit
                        )
                    Fill: =RGBA(160, 0, 2, 1)
                    FocusedBorderColor: =ColorFade(Self.Fill, 75%)
                    Font: =Font.Lato
                    Height: =31
                    OnSelect: |-
                        =If(
                            ThisItem.status = 'status (Visits_1)'.Started,
                            Patch(
                                Visits_1,
                                LookUp(
                                    Visits_1,
                                    'Visit ID' = ThisItem.'Visit ID'
                                ),
                                {
                                    status: 'status (Visits_1)'.Completed,
                                    'Check-out Location': Concatenate(
                                        Location.Latitude,
                                        ",",
                                        Location.Longitude
                                    )
                                }
                            );
                            Notify(
                                "Your visit has been successfully ended.",
                                NotificationType.Success,
                                2500
                            );
                            ,
                            Notify(
                                "Your Visit hasn't been started yet",
                                NotificationType.Warning,
                                1000
                            )
                        )
                    Size: =16
                    Text: ="END"
                    Width: =131
                    X: =317
                    Y: =211
                    ZIndex: =25

    "'Bottom Navigation_4' As 'Bottom Navigation'":
        NavItems: |-
            =Table( {
                    Title: If(varAttendance = "end" , "End", varAttendance = "start" , "Start", varAttendance = "done" , "Ended"),
                    //Title: Start,
                    Screen: If(varAttendance= "start" , StartDay, varAttendance= "end" , 'End day', varAttendance= "done" , 'Day Ended' ),
                
                    Icon: CalendarBlank,
                    Active: false
                },
                {
                    Title: "Visits",
                    Screen: Visits,
                    Icon: Waypoint,
                    Active: true
                },
                {
                    Title: "Dashboard",
                    Screen: Home,
                    Icon: Waffle,
                    Active: false
                },
                {
                    Title: "Orders",
                    Screen: 'All Orders',
                    Icon: ShoppingCart,
                    Active: false
                }
                )
        Y: =1056
        ZIndex: =2

    "'Header Component_30' As 'Header Component_11'":
        Height: =74
        ZIndex: =3

    "'Visit DatePicker' As datepicker":
        BorderColor: =RGBA(65, 76, 96, 1)
        BorderThickness: =1
        Color: =RGBA(255, 255, 255, 1)
        Fill: =RGBA(103, 204, 107, 0.02)
        FocusedBorderThickness: =2
        Font: =Font.Lato
        Height: =41
        IconBackground: |-
            =ColorValue("#414C60")
        IconFill: =RGBA(255,255,255,1)
        OnChange: =Set(SelectedVisitDate, 'Visit DatePicker'.SelectedDate)
        Width: =274
        X: =349
        Y: =82
        ZIndex: =4

    Circle_1 As circle:
        Fill: =RGBA(160, 0, 2, 1)
        Height: =80
        HoverFill: =
        OnSelect: =Set(varIconSelected, !varIconSelected)
        PressedFill: =
        Width: =80
        X: =526
        Y: =959
        ZIndex: =6

    add_1 As icon.Add:
        Color: =RGBA(255, 255, 255, 1)
        Height: =54
        HoverColor: =RGBA(255, 255, 255, 1)
        Icon: =If(varIconSelected, Icon.HorizontalLine, Icon.Add)
        OnSelect: =Set(varIconSelected, !varIconSelected)
        Width: =39
        X: =546
        Y: =972
        ZIndex: =7

    Planned_1 As button:
        BorderThickness: =0
        Fill: =RGBA(160, 0, 2, 1)
        FocusedBorderColor: =ColorFade(Self.Fill, 75%)
        Height: =66
        HoverFill: =
        OnSelect: =Navigate('Customer (Dist)', ScreenTransition.Fade)
        Size: =21
        Text: ="UNPLANNED VISIT"
        Visible: =varIconSelected
        Width: =310
        X: =290
        Y: =882
        ZIndex: =8

    Unplanned_1 As button:
        BorderThickness: =0
        Fill: =RGBA(160, 0, 2, 1)
        FocusedBorderColor: =ColorFade(Self.Fill, 75%)
        Height: =66
        HoverFill: =
        OnSelect: =Navigate('Customer (Dist) Plan Visit', ScreenTransition.Fade)
        Size: =21
        Text: ="PLAN VISIT"
        Visible: =varIconSelected
        Width: =310
        X: =290
        Y: =806
        ZIndex: =9

    Gallery4_1 As gallery.galleryHorizontal:
        Height: =64
        Items: |-
            =[
                {
                    title: "Today",
                    date: Today()
                },
                 {
                    title: "Yesterday",
                    date: Today()+1
                }
                
            ]
        OnSelect: =Set(SelectedVisitDate, ThisItem.Value.date)
        ShowScrollbar: =false
        TemplateSize: =157
        Width: =334
        X: =3
        Y: =74
        ZIndex: =10

        Button4_1 As button:
            BorderColor: =RGBA(65, 76, 96, 1)
            Color: |-
                =If(ThisItem.IsSelected, ColorValue("#414C60"),RGBA(255, 255, 255, 1))
            Fill: |-
                =If(ThisItem.IsSelected, White,ColorValue("#414C60") )
            FocusedBorderColor: =
            FocusedBorderThickness: =2
            Font: =Font.Lato
            Height: =36
            HoverBorderColor: =RGBA(53, 166, 57, 1)
            HoverColor: =RGBA(0, 0, 0, 0)
            HoverFill: =RGBA(0, 0, 0, 0)
            OnSelect: =Select(Parent)
            PressedBorderColor: =
            PressedFill: =
            Size: =14
            Text: =ThisItem.Value.title
            Width: =130
            X: =15
            Y: =6
            ZIndex: =1

    EditBackdrop As rectangle:
        Fill: =RGBA(230, 230, 230, 0.5)
        Height: =1136
        HoverFill: =
        Visible: =VarDialogOpen
        Width: =640
        ZIndex: =11

    "'Side Bar_1' As 'Side Bar'":
        ZIndex: =17

    "'Edit backdrop' As rectangle":
        Fill: =RGBA(230, 230, 230, 0.5)
        Height: =1136
        HoverFill: =
        Visible: =VarEditDialogOpen
        Width: =640
        ZIndex: =18

    Label8 As label:
        Font: =Font.Lato
        Height: =51
        Size: =18
        Text: ="Customer"
        Visible: =VarEditDialogOpen
        Width: =156
        X: =112
        Y: =422
        ZIndex: =23

    "'Edit form' As group":
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =23

        Rectangle7_4 As rectangle:
            BorderColor: =RGBA(204, 204, 204, 1)
            Fill: =RGBA(237, 237, 237, 1)
            Height: =335
            HoverFill: =RGBA(237, 237, 237, 1)
            OnSelect: |-
                =If(VarDialogOpen, Patch(
                    Visits_1,
                    Defaults(Visits_1),
                    {'Visit Type':'Visit Type (Visits_1)'.Unplanned}
                );
                )
            PressedFill: =RGBA(237, 237, 237, 1)
            Visible: =VarEditDialogOpen
            Width: =550
            X: =45
            Y: =350
            ZIndex: =19

        Icon10_4 As icon.Cancel:
            Color: =RGBA(128, 128, 128, 1)
            Height: =37
            Icon: =Icon.Cancel
            OnSelect: =Set(VarEditDialogOpen, false)
            Visible: =VarEditDialogOpen
            Width: =37
            X: =543
            Y: =363
            ZIndex: =20

        Button2_7 As button:
            DisplayMode: =If(DatePicker1.SelectedDate < Today(), Disabled, DisplayMode.Edit)
            FocusedBorderColor: =ColorFade(Self.Fill, 75%)
            Font: =Font.Lato
            FontWeight: =FontWeight.Bold
            Height: =45
            OnSelect: |-
                =Patch(
                    Visits_1,
                    LookUp(
                        Visits_1,
                        'Visit ID' = First(SelectedVisitForEdit).'Visit ID'
                    ),
                    {'Visit Date': DatePicker1.SelectedDate}
                );
                Set(VarEditDialogOpen, false);
                Notify("Visit has been updated", NotificationType.Success, 2000);
            Size: =14
            Text: ="CONFIRM"
            Visible: =VarEditDialogOpen
            Width: =137
            X: =252
            Y: =595
            ZIndex: =22

    Label8_1 As label:
        Font: =Font.Lato
        FontWeight: =FontWeight.Semibold
        Height: =51
        Size: =18
        Text: =First(SelectedVisitForEdit).Customer.'Account Name (name)'
        Visible: =VarEditDialogOpen
        Width: =289
        X: =274
        Y: =422
        ZIndex: =24

    Label8_2 As label:
        Font: =Font.Lato
        Height: =51
        Size: =18
        Text: ="Date"
        Visible: =VarEditDialogOpen
        Width: =156
        X: =112
        Y: =478
        ZIndex: =25

    DatePicker1 As datepicker:
        BorderThickness: =1
        DefaultDate: =First(SelectedVisitForEdit).'Visit Date'
        Font: =Font.Lato
        Height: =39
        Size: =16
        Visible: =VarEditDialogOpen
        Width: =198
        X: =276
        Y: =490
        ZIndex: =28

    Label8_4 As label:
        Color: =RGBA(255, 0, 0, 1)
        Font: =Font.Lato
        FontWeight: =FontWeight.Semibold
        Height: =28
        Size: =12
        Text: ="Visit Date can not be less than today"
        Visible: =VarEditDialogOpen && DatePicker1.SelectedDate <= Today()
        Width: =295
        X: =268
        Y: =543
        ZIndex: =29

    EditModal As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =30

        Rectangle7_1 As rectangle:
            BorderColor: =RGBA(204, 204, 204, 1)
            Fill: =RGBA(237, 237, 237, 1)
            Height: =335
            HoverFill: =RGBA(237, 237, 237, 1)
            OnSelect: |-
                =If(VarDialogOpen, Patch(
                    Visits_1,
                    Defaults(Visits_1),
                    {cr431_visittype:'Visit Type (Visits_1)'.'254460001',
                    cr431_customer: LookUp(Accounts, )}
                );
                )
            PressedFill: =RGBA(237, 237, 237, 1)
            Visible: =VarDialogOpen
            Width: =550
            X: =45
            Y: =350
            ZIndex: =12

        Icon10_1 As icon.Cancel:
            Color: =RGBA(128, 128, 128, 1)
            Height: =37
            Icon: =Icon.Cancel
            OnSelect: =Set(VarDialogOpen, false)
            Visible: =VarDialogOpen
            Width: =37
            X: =543
            Y: =363
            ZIndex: =13

        Label7_1 As label:
            Align: =Align.Center
            Color: =RGBA(31, 31, 31, 1)
            Font: =Font.Lato
            FontWeight: =FontWeight.Semibold
            Height: =119
            OnSelect: |
                =Switch(
                    varAttendance,
                    "start",
                    Notify(
                        "Please start your day first",
                        NotificationType.Warning,
                        1000
                    ),
                    "end",
                    Patch(
                        Visits_1,
                        LookUp(
                            Visits_1,
                            'Visit ID' = ClickedVisit.'Visit ID'
                        ),
                        {status: 'status (Visits_1)'.Started}
                    );
                    Navigate(
                        'Start visit',
                        ScreenTransition.Cover
                    ),
                    "done",
                    Notify(
                        "Your day has ended",
                        NotificationType.Warning,
                        1000
                    )
                );
            Size: =21
            Text: |-
                =If(
                    ClickedVisit.status = 'status (Visits_1)'.Open,
                    Concatenate(
                        "Do you want to start the visit for ",
                        ClickedVisit.Customer.'Account Name (name)',
                        " ?"
                    ),
                    Concatenate(
                        "Do you want to resume the visit for ",
                        ClickedVisit.Customer.'Account Name (name)',
                        " ?"
                    )
                )
            Visible: =VarDialogOpen
            Width: =488
            X: =75
            Y: =436
            ZIndex: =14

        Button2_2 As button:
            FocusedBorderColor: =ColorFade(Self.Fill, 75%)
            Font: =Font.Lato
            FontWeight: =FontWeight.Bold
            Height: =45
            OnSelect: |
                =Switch(
                    varAttendance,
                    "start",
                    Notify(
                        "Please start your day first",
                        NotificationType.Warning,
                        1000
                    );
                    Navigate(
                        StartDay,
                        ScreenTransition.Fade
                    );
                    ,
                    "end",
                    Patch(
                        Visits_1,
                        LookUp(
                            Visits_1,
                            'Visit ID' = ClickedVisit.'Visit ID'
                        ),
                        {
                            status: 'status (Visits_1)'.Started,
                            'Check- In Location': Concatenate(
                                Location.Latitude,
                                ",",
                                Location.Longitude
                            )
                        }
                    );
                    Patch(
                        Accounts,
                        LookUp(
                            Accounts,
                            Account = ClickedVisit.Customer.Account
                        ),
                        {
                            'Last Vist Date': Today(),
                            'Last Order Date': Today()
                        }
                    );
                    Navigate(
                        'Start visit',
                        ScreenTransition.Cover
                    ),
                    "done",
                    Notify(
                        "Your day has ended",
                        NotificationType.Warning,
                        1000
                    )
                );
            Size: =14
            Text: ="CONFIRM"
            Visible: =VarDialogOpen
            Width: =137
            X: =252
            Y: =597
            ZIndex: =15

    Group15 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =31

        "'Visit Search' As text":
            BorderThickness: =1
            Color: =RGBA(255, 255, 255, 1)
            Default: =""
            FocusedBorderThickness: =2
            Font: =Font.Lato
            Height: =39
            HintText: ="Search Visits"
            PaddingLeft: =45
            RadiusBottomLeft: =10
            RadiusBottomRight: =10
            RadiusTopLeft: =10
            RadiusTopRight: =10
            Size: =15
            Width: =421
            X: =193
            Y: =15
            ZIndex: =5

        Icon12 As icon.Search:
            Color: =RGBA(255, 255, 255, 1)
            Height: =34
            Icon: =Icon.Search
            Width: =24
            X: =207
            Y: =17
            ZIndex: =16

